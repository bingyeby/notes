# 响应式的优雅实现


### 实现相应式的方法
    1. 通过相应式的单位: vw %
    2. 通过媒体查询 @media

### 改良媒体查询
    简单的响应式是通过在不同的屏幕尺寸下设置相应的样式
    下面的代码实现了小屏长度为100px,大屏长度为500px,此种写法兼顾不了中间屏幕的尺寸,在具体代码实现过程中常会影响布局;
```css
.box {
    width: 100px;
}
@media screen and (min-width: 375px) {
    .box {
        width: 100px;
    }
}
@media screen and (min-width: 1600px) {
    .box {
        width: 500px;
    }
}
```
    
    通过细化min-width的值来进行优化,设置多个临界点即可,若临界点够多,则不会出现跳变的现象,也更容易控制页面元素在不同屏幕尺寸下的长度或者大小;
    但是增加临界点则会增加代码量,导致代码臃肿,结合scss函数可进行优化;

    封装如下scss函数可以简化代码:
        $name为属性名
        $valueList为属性值的列表,至少有两个值,代表变化范围的最小值与最大值,除去首尾值的中间值将被设置为其他中间屏幕尺寸点下该元素的状态值,该中间屏幕尺寸点由最小屏幕尺寸与最大屏幕尺寸的差值均分获取
        $stepLength为最小屏幕尺寸与最大屏幕尺寸之间均分点的个数,代表有几个区间点,设置值越大则越细化变化幅度,跳变的感觉越小
    
    以横轴来描述不同的使用方法下的效果:
        @include stepResponsive(width, (10px, 100px));
        ----10px----][-------------10px--------------------------------][--100px-----------(属性值)
        ----------375px----------------------------------------------1600px---------------(屏幕宽度)


        @include stepResponsive(width, (10px, 80px, 100px));
        ----10px---][-------------10px--------------------][---80px-----------][--100px---------------(属性值)
        ----------375px---------------------------------1191px-------------1600px------------------(屏幕宽度)

        @include stepResponsive(width, (10px, 100px),5);
        -----10px--][-----10px------][---46px-------][-------64px------][----82px--------][----100px---------(属性值)
        ----------375px------------865px----------1110px------------ 1355px------------1600px---------------(屏幕宽度)
    

```scss
// 阶梯型响应式
@mixin stepResponsive($name,$valueList,$stepLength:2) {
  $resList: 375px, 1600px;

  $valueListSize: length($valueList);

  $resListFirst: nth($resList, 1); // 头部
  $resListLast: nth($resList, length($resList)); // 尾部

  // 如果 stepLength 高于 length($valueList),则重置$valueList
  @if $stepLength > $valueListSize {
    $valueListFirst: nth($valueList, 1); // 头部
    $valueListLast: nth($valueList, length($valueList)); // 尾部

    $valueList: ($valueListFirst);
    @for $i from 2 through $stepLength {
      @debug '1111111' $i;
      $valueList: append($valueList, #{$valueListFirst + ($valueListLast - $valueListFirst) / $stepLength * $i}); // 补充剩余的
    }
    $valueListSize: length($valueList);
  }
  @debug '>>>>>>>>' $valueList; // (头部值, ..中间值.., 尾部值)

  $resListChange: ($resListFirst);
  @for $i from 2 through $valueListSize {
    @debug '1111111' $i;
    $resListChange: append($resListChange, #{$resListFirst + ($resListLast - $resListFirst) / $valueListSize * $i}); // 补充剩余的
  }
  @debug '>>>>>>>>' $resListChange; // (头部值, ..中间值.., 尾部值)

  #{$name}: nth($valueList, 1);
  @each $res in $valueList {
    $index: index($valueList, $res);
    @media only screen and (min-width: nth($resListChange, $index)) {
      #{$name}: $res;
    }
  }
}

```

### 固定临界点
```scss
@mixin responseWidth($list) {
  @each $point, $size in $list {
    //设置一个默认的值
    @if $point == "null" {
      width: $size;
    } @else {
      @media screen and (min-width: $point) {
        width: $size;
      }
    }
  }
}

  $widthList: (
    'null' : 100px,
    '480px': 200px,
    '728px': 300px,
    '1200px': 400px,
  );
  .test {
    @include responseWidth($widthList);
    border-bottom: 10px solid lightcoral;
  }
```

### 基于vw等viewport视区单位配合rem响应式排版和布局
https://www.zhangxinxu.com/wordpress/2016/08/vw-viewport-responsive-layout-typography/#comments
```scss
html {
  font-size: calc(75% + 4 * (100vw - 375px) / (768 - 375));
  @media screen and (min-width: 768px) {
    font-size: calc(100% + 4 * (100vw - 768px) / (1366 - 768));
  }
  @media screen and (min-width: 1366px) { // 设计稿
    font-size: calc(125% + 10 * (100vw - 1366px) / 1366);
  }
}

@function px2rem($px) { // 设计稿psd
  @return ($px / 16px) * 1rem;
}
```

### 控制小屏独有的样式
```scss
@mixin xsView {
  @media screen and (max-width: 768px) {
    @content;
  }
}
```

```js
+    "cssnano": "^4.1.10",
+    "postcss-aspect-ratio-mini": "^1.0.1",
+    "postcss-cssnext": "^3.1.0",
+    "postcss-import": "^12.0.1",
+    "postcss-px-to-viewport": "^1.1.1",
+    "postcss-viewport-units": "^0.1.6",
+    "postcss-write-svg": "^3.0.1",
+    "cssnano-preset-advanced": "^4.0.7",
```

